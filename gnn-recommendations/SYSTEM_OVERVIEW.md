# ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ GNN-Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¹

## ğŸ“‹ ĞšÑ€Ğ°Ñ‚ĞºĞ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ

Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ğ»Ñ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ² Graph Neural Networks Ğ² Ğ·Ğ°Ğ´Ğ°Ñ‡Ğµ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¹ Ñ Ñ„Ğ¾ĞºÑƒÑĞ¾Ğ¼ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñƒ over-smoothing. Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾ 7 Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹ (6 baseline + GroupShuffleGNN) Ğ½Ğ° 3 Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ğ°Ñ….

---

## ğŸ—‚ï¸ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
gnn-recommendations/
â”‚
â”œâ”€â”€ ğŸ“Š data/                          # Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ
â”‚   â”œâ”€â”€ raw/                          # Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ñ‹
â”‚   â””â”€â”€ processed/                    # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
â”‚
â”œâ”€â”€ âš™ï¸ config/                         # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
â”‚   â”œâ”€â”€ datasets/                     # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ğ¾Ğ²
â”‚   â”‚   â”œâ”€â”€ movie_lens.yaml
â”‚   â”‚   â”œâ”€â”€ book_crossing.yaml
â”‚   â”‚   â””â”€â”€ gowalla.yaml
â”‚   â”œâ”€â”€ models/                       # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
â”‚   â”‚   â”œâ”€â”€ bpr_mf.yaml
â”‚   â”‚   â”œâ”€â”€ lightgcn.yaml
â”‚   â”‚   â”œâ”€â”€ gcnii.yaml
â”‚   â”‚   â”œâ”€â”€ dgr.yaml
â”‚   â”‚   â”œâ”€â”€ svd_gcn.yaml
â”‚   â”‚   â”œâ”€â”€ layergcn.yaml
â”‚   â”‚   â””â”€â”€ groupshuffle_gnn.yaml
â”‚   â””â”€â”€ training.yaml                 # ĞĞ±Ñ‰Ğ¸Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ
â”‚
â”œâ”€â”€ ğŸ§  src/                            # Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´
â”‚   â”œâ”€â”€ data/                         # Data pipeline
â”‚   â”‚   â”œâ”€â”€ dataset.py                # ĞšĞ»Ğ°ÑÑ RecommendationDataset
â”‚   â”‚   â”œâ”€â”€ loaders.py                # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ñ‡Ğ¸ĞºĞ¸ Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ğ¾Ğ²
â”‚   â”‚   â”œâ”€â”€ preprocessing.py          # Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ, Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â””â”€â”€ graph.py                  # ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ Ğ³Ñ€Ğ°Ñ„Ğ¾Ğ²
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                       # ĞœĞ¾Ğ´ĞµĞ»Ğ¸
â”‚   â”‚   â”œâ”€â”€ base.py                   # BaseRecommender (Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ)
â”‚   â”‚   â”œâ”€â”€ baselines/                # 6 baseline Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
â”‚   â”‚   â”‚   â”œâ”€â”€ bpr_mf.py
â”‚   â”‚   â”‚   â”œâ”€â”€ lightgcn.py
â”‚   â”‚   â”‚   â”œâ”€â”€ gcnii.py
â”‚   â”‚   â”‚   â”œâ”€â”€ dgr.py
â”‚   â”‚   â”‚   â”œâ”€â”€ svd_gcn.py
â”‚   â”‚   â”‚   â””â”€â”€ layergcn.py
â”‚   â”‚   â””â”€â”€ group_shuffle/            # GroupShuffleGNN
â”‚   â”‚       â”œâ”€â”€ layers.py             # GroupShuffleLayer
â”‚   â”‚       â”œâ”€â”€ model.py              # GroupShuffleGNN
â”‚   â”‚       â””â”€â”€ utils.py              # Ğ’ÑĞ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ training/                     # ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ
â”‚   â”‚   â”œâ”€â”€ trainer.py                # ĞšĞ»Ğ°ÑÑ Trainer
â”‚   â”‚   â”œâ”€â”€ losses.py                 # BPR Loss
â”‚   â”‚   â””â”€â”€ metrics.py                # ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ (Recall, NDCG, etc)
â”‚   â”‚
â”‚   â””â”€â”€ evaluation/                   # ĞÑ†ĞµĞ½ĞºĞ°
â”‚       â””â”€â”€ evaluator.py              # ĞšĞ»Ğ°ÑÑ Evaluator
â”‚
â”œâ”€â”€ ğŸš€ scripts/                        # Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°
â”‚   â”œâ”€â”€ prepare_data.py               # ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
â”‚   â”œâ”€â”€ train_model.py                # ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
â”‚   â”œâ”€â”€ run_all_experiments.py        # Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ²ÑĞµÑ… ÑĞºÑĞ¿ĞµÑ€Ğ¸Ğ¼ĞµĞ½Ñ‚Ğ¾Ğ²
â”‚   â””â”€â”€ test_all_models.py            # Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
â”‚
â”œâ”€â”€ ğŸ“Š results/                        # Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
â”‚   â”œâ”€â”€ checkpoints/                  # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
â”‚   â”œâ”€â”€ experiments/                  # Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑĞºÑĞ¿ĞµÑ€Ğ¸Ğ¼ĞµĞ½Ñ‚Ğ¾Ğ² (JSON/CSV)
â”‚   â””â”€â”€ logs/                         # Ğ›Ğ¾Ğ³Ğ¸ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ
â”‚
â””â”€â”€ ğŸ”¬ experiments/                    # Ğ­ĞºÑĞ¿ĞµÑ€Ğ¸Ğ¼ĞµĞ½Ñ‚Ñ‹ (Ğ¿ÑƒÑÑ‚Ñ‹Ğµ Ğ¿Ğ°Ğ¿ĞºĞ¸)
    â”œâ”€â”€ depth_analysis/
    â”œâ”€â”€ ablations/
    â”œâ”€â”€ efficiency/
    â””â”€â”€ oversmoothing/
```

---

## ğŸ”„ ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ­Ğ¢ĞĞŸ 1: Ğ”ĞĞĞĞ«Ğ•                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ñ‹ (raw/)           â”‚
         â”‚   â€¢ MovieLens (ratings.dat)          â”‚
         â”‚   â€¢ Book-Crossing (ratings.csv)      â”‚
         â”‚   â€¢ Gowalla (checkins.txt)           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   RecommendationDataset.load_raw()   â”‚
         â”‚   Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ñ‡ĞµÑ€ĞµĞ· Loaders             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   RecommendationDataset.preprocess() â”‚
         â”‚   â€¢ Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ²              â”‚
         â”‚   â€¢ Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ (min 10 interactions) â”‚
         â”‚   â€¢ Ğ‘Ğ¸Ğ½Ğ°Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (implicit feedback)  â”‚
         â”‚   â€¢ ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ID (0,1,2,...)      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   RecommendationDataset.split()      â”‚
         â”‚   train / valid / test               â”‚
         â”‚   (80% / 10% / 10%)                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   RecommendationDataset.build_graph()â”‚
         â”‚   Bipartite Ğ³Ñ€Ğ°Ñ„ user-item           â”‚
         â”‚   Normalized adjacency matrix        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² processed/            â”‚
         â”‚   â€¢ train.txt, valid.txt, test.txt   â”‚
         â”‚   â€¢ adjacency_matrix.npz             â”‚
         â”‚   â€¢ metadata.json                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ­Ğ¢ĞĞŸ 2: ĞœĞĞ”Ğ•Ğ›Ğ˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                       â”‚
        â–¼                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Baseline Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ â”‚                  â”‚  GroupShuffleGNN â”‚
â”‚                  â”‚                  â”‚  (Ğ²Ğ°Ñˆ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼)  â”‚
â”‚  â€¢ BPR-MF        â”‚                  â”‚                  â”‚
â”‚  â€¢ LightGCN      â”‚                  â”‚  â€¢ GroupShuffle  â”‚
â”‚  â€¢ GCNII         â”‚                  â”‚    Layer         â”‚
â”‚  â€¢ DGR           â”‚                  â”‚  â€¢ ĞÑ€Ñ‚Ğ¾Ğ³Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ â”‚
â”‚  â€¢ SVD-GCN       â”‚                  â”‚    Ñ‚Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ â”‚
â”‚  â€¢ LayerGCN      â”‚                  â”‚  â€¢ Residual      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Ğ’ÑĞµ Ğ½Ğ°ÑĞ»ĞµĞ´ÑƒÑÑ‚ÑÑ Ğ¾Ñ‚ BaseRecommender â”‚
         â”‚   â€¢ forward(adj_matrix)              â”‚
         â”‚   â€¢ predict(users, items)            â”‚
         â”‚   â€¢ get_all_embeddings()             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ­Ğ¢ĞĞŸ 3: ĞĞ‘Ğ£Ğ§Ğ•ĞĞ˜Ğ•                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Trainer(model, dataset, config)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Ğ¦Ğ¸ĞºĞ» Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ (Ğ´Ğ¾ 300 ÑĞ¿Ğ¾Ñ…)        â”‚
         â”‚                                      â”‚
         â”‚   FOR ĞºĞ°Ğ¶Ğ´Ğ°Ñ ÑĞ¿Ğ¾Ñ…Ğ°:                  â”‚
         â”‚     1. Forward pass Ñ‡ĞµÑ€ĞµĞ· Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ     â”‚
         â”‚     2. Sample batch (users, +/- items)â”‚
         â”‚     3. Compute scores                â”‚
         â”‚     4. BPR Loss                      â”‚
         â”‚     5. Backward pass                 â”‚
         â”‚     6. Update parameters             â”‚
         â”‚                                      â”‚
         â”‚   ĞšĞĞ–Ğ”Ğ«Ğ• 10 ÑĞ¿Ğ¾Ñ…:                    â”‚
         â”‚     â€¢ Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° valid set         â”‚
         â”‚     â€¢ Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº              â”‚
         â”‚     â€¢ Early stopping check           â”‚
         â”‚     â€¢ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ checkpoint          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Early Stopping (patience=20)       â”‚
         â”‚   Ğ›ÑƒÑ‡ÑˆĞ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ°            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ­Ğ¢ĞĞŸ 4: ĞĞ¦Ğ•ĞĞšĞ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Evaluator.evaluate(model, test)    â”‚
         â”‚                                      â”‚
         â”‚   1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ embeddings             â”‚
         â”‚      user_emb, item_emb = model()    â”‚
         â”‚                                      â”‚
         â”‚   2. Compute scores Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¿Ğ°Ñ€     â”‚
         â”‚      scores = user_emb @ item_emb.T  â”‚
         â”‚                                      â”‚
         â”‚   3. ĞœĞ°ÑĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ train items         â”‚
         â”‚      scores[train_mask] = -inf       â”‚
         â”‚                                      â”‚
         â”‚   4. TopK Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸               â”‚
         â”‚      top_k_items = topk(scores)      â”‚
         â”‚                                      â”‚
         â”‚   5. Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸               â”‚
         â”‚      â€¢ Recall@10, @20, @50           â”‚
         â”‚      â€¢ NDCG@10, @20, @50             â”‚
         â”‚      â€¢ Precision@10                  â”‚
         â”‚      â€¢ Coverage                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²             â”‚
         â”‚   â€¢ results/experiments/*.json       â”‚
         â”‚   â€¢ results/experiments/*.csv        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§® ĞšĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: LightGCN)

```
Ğ’Ñ…Ğ¾Ğ´: adjacency_matrix [N, N], Ğ³Ğ´Ğµ N = n_users + n_items

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ¡Ğ›ĞĞ™ 0: ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ embeddings                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ User Embeddingsâ”‚         â”‚ Item Embeddingsâ”‚          â”‚
â”‚  â”‚ [n_users, 64]  â”‚         â”‚ [n_items, 64]  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚           â”‚                          â”‚                  â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                      â–¼                                  â”‚
â”‚             Concat: [N, 64]                             â”‚
â”‚             eâ½â°â¾ = [user_emb; item_emb]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ¡Ğ›ĞĞ™ 1: Ğ“Ñ€Ğ°Ñ„Ğ¾Ğ²Ğ°Ñ ÑĞ²ĞµÑ€Ñ‚ĞºĞ°                               â”‚
â”‚                                                         â”‚
â”‚  eâ½Â¹â¾ = Ãƒ Ã— eâ½â°â¾                                        â”‚
â”‚                                                         â”‚
â”‚  Ğ³Ğ´Ğµ Ãƒ - normalized adjacency matrix                   â”‚
â”‚  (Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ embeddings ÑĞ¾ÑĞµĞ´ĞµĞ¹)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ¡Ğ›ĞĞ™ 2: Ğ“Ñ€Ğ°Ñ„Ğ¾Ğ²Ğ°Ñ ÑĞ²ĞµÑ€Ñ‚ĞºĞ°                               â”‚
â”‚  eâ½Â²â¾ = Ãƒ Ã— eâ½Â¹â¾                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ¡Ğ›ĞĞ™ 3: Ğ“Ñ€Ğ°Ñ„Ğ¾Ğ²Ğ°Ñ ÑĞ²ĞµÑ€Ñ‚ĞºĞ°                               â”‚
â”‚  eâ½Â³â¾ = Ãƒ Ã— eâ½Â²â¾                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER AGGREGATION                                      â”‚
â”‚                                                         â”‚
â”‚  e_final = (eâ½â°â¾ + eâ½Â¹â¾ + eâ½Â²â¾ + eâ½Â³â¾) / 4              â”‚
â”‚                                                         â”‚
â”‚  (ÑÑ€ĞµĞ´Ğ½ĞµĞµ Ğ°Ñ€Ğ¸Ñ„Ğ¼ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ²ÑĞµÑ… ÑĞ»Ğ¾ĞµĞ²)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SPLIT Ğ½Ğ° users Ğ¸ items                                 â”‚
â”‚                                                         â”‚
â”‚  user_emb_final  = e_final[:n_users]                   â”‚
â”‚  item_emb_final  = e_final[n_users:]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PREDICTION                                             â”‚
â”‚                                                         â”‚
â”‚  score(u, i) = user_emb_final[u] Â· item_emb_final[i]   â”‚
â”‚                                                         â”‚
â”‚  (ÑĞºĞ°Ğ»ÑÑ€Ğ½Ğ¾Ğµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ğ’Ñ‹Ñ…Ğ¾Ğ´: scores Ğ´Ğ»Ñ user-item Ğ¿Ğ°Ñ€
```

---

## ğŸ”„ GroupShuffleGNN vs LightGCN

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         LightGCN                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  eâ½Ë¡âºÂ¹â¾ = Ãƒ Ã— eâ½Ë¡â¾                                           â”‚
â”‚                                                              â”‚
â”‚  ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: over-smoothing                                   â”‚
â”‚  Ğ’ÑĞµ embeddings ÑÑ‚Ñ€ĞµĞ¼ÑÑ‚ÑÑ Ğº Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞµ Ğ¿Ñ€Ğ¸ l â†’ âˆ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GroupShuffleGNN                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  eâ½Ë¡âºÂ¹â¾ = Î±Â·eâ½Ë¡â¾ + (1-Î±)Â·QÂ·(Ãƒ Ã— eâ½Ë¡â¾)                        â”‚
â”‚           â†‘            â†‘                                     â”‚
â”‚        residual    Ğ¾Ñ€Ñ‚Ğ¾Ğ³Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ                            â”‚
â”‚                    Ñ‚Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Q                          â”‚
â”‚                                                              â”‚
â”‚  Q - Ğ¾Ñ€Ñ‚Ğ¾Ğ³Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†Ğ° (Q^T Q = I)                     â”‚
â”‚  Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ½Ğ¾Ñ€Ğ¼Ñƒ: ||QÂ·x|| = ||x||                          â”‚
â”‚  Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ ÑƒĞ³Ğ»Ñ‹: cos(QÂ·x, QÂ·y) = cos(x, y)                 â”‚
â”‚                                                              â”‚
â”‚  â†’ Ğ‘Ğ¾Ñ€ÑŒĞ±Ğ° Ñ over-smoothing Ñ‡ĞµÑ€ĞµĞ· ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ³ĞµĞ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ğ¸       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ: BPR Loss

```
Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°: ĞĞ°ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Ñ€Ğ°Ğ½Ğ¶Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ items

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ u:                                â”‚
â”‚                                                              â”‚
â”‚  â€¢ Positive item iâº: item Ñ ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ             â”‚
â”‚                      Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ»                        â”‚
â”‚                                                              â”‚
â”‚  â€¢ Negative item iâ»: ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹ item (ĞĞ• Ğ¸Ğ· train set)       â”‚
â”‚                                                              â”‚
â”‚  Ğ¦ĞµĞ»ÑŒ: score(u, iâº) > score(u, iâ»)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BPR Loss:                                                   â”‚
â”‚                                                              â”‚
â”‚  L = -log Ïƒ(score(u,iâº) - score(u,iâ»))                      â”‚
â”‚                                                              â”‚
â”‚  Ğ³Ğ´Ğµ Ïƒ(x) = 1/(1+eâ»Ë£) - sigmoid                             â”‚
â”‚                                                              â”‚
â”‚  ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ L â†’ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ€Ğ°Ğ·Ğ½Ğ¸Ñ†Ñ‹ scores                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ±Ğ°Ñ‚Ñ‡Ğ°:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User ID â”‚ Pos Item â”‚ Neg Item â”‚ Pos Score  â”‚ Neg Score  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   42    â”‚   15     â”‚   78     â”‚    0.85    â”‚    0.32    â”‚
â”‚  103    â”‚   99     â”‚   12     â”‚    0.71    â”‚    0.18    â”‚
â”‚   17    â”‚    3     â”‚   56     â”‚    0.92    â”‚    0.41    â”‚
â”‚  ...    â”‚  ...     â”‚  ...     â”‚    ...     â”‚    ...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    BPR Loss = 0.23
                            â”‚
                            â–¼
                    Backward pass
                            â”‚
                            â–¼
                Update model parameters
```

---

## ğŸ“Š ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¾Ñ†ĞµĞ½ĞºĞ¸

### Recall@K
```
Recall@K = (Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ñ‹Ğµ items Ğ² Ñ‚Ğ¾Ğ¿-K) / (Ğ²ÑĞµĞ³Ğ¾ Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ñ‹Ñ…)

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: K=10
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ 42:                                     â”‚
â”‚                                                      â”‚
â”‚ Ğ ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ñ‹Ğµ items (Ğ¸Ğ· test): {15, 23, 78, 91}       â”‚
â”‚                               â†‘ Ğ²ÑĞµĞ³Ğ¾ 4 items        â”‚
â”‚                                                      â”‚
â”‚ Ğ¢Ğ¾Ğ¿-10 Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¹: [15, 7, 23, 12, 45, 67, ...]   â”‚
â”‚                       â†‘     â†‘                        â”‚
â”‚                  HIT!   HIT!                         â”‚
â”‚                                                      â”‚
â”‚ Recall@10 = 2 / 4 = 0.50                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### NDCG@K
```
NDCG@K = DCG@K / IDCG@K

Ğ£Ñ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ñ‹Ñ… items Ğ² Ñ‚Ğ¾Ğ¿-K

DCG = Î£ (rel_i / logâ‚‚(i+1))  Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ i

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: K=5
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ğ¢Ğ¾Ğ¿-5: [15âœ“, 7âœ—, 23âœ“, 12âœ—, 91âœ“]                     â”‚
â”‚         pos:  1    2    3    4    5                  â”‚
â”‚         rel:  1    0    1    0    1                  â”‚
â”‚                                                      â”‚
â”‚ DCG = 1/logâ‚‚(2) + 0 + 1/logâ‚‚(4) + 0 + 1/logâ‚‚(6)     â”‚
â”‚     = 1.0 + 0 + 0.5 + 0 + 0.387                      â”‚
â”‚     = 1.887                                          â”‚
â”‚                                                      â”‚
â”‚ IDCG = 1.0 + 0.631 + 0.5 = 2.131 (Ğ¸Ğ´ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº)â”‚
â”‚                                                      â”‚
â”‚ NDCG@5 = 1.887 / 2.131 = 0.885                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš ï¸ Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ±Ğ°Ğ³Ğ¸

### 1. âŒ Embeddings Ğ±ĞµĞ· Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
```python
# Ğ”Ğ (ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):
def train_epoch():
    user_emb, item_emb = model(adj_matrix)  # Ğ’ĞĞ• Ñ†Ğ¸ĞºĞ»Ğ°!
    for batch in batches:
        scores = (user_emb[users] * item_emb[items]).sum()
        loss.backward()  # Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ñ‹ ĞĞ• Ğ¸Ğ´ÑƒÑ‚ Ğ² Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ!

# ĞŸĞĞ¡Ğ›Ğ• (ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):
def train_epoch():
    for batch in batches:
        user_emb, item_emb = model(adj_matrix)  # Ğ’ĞĞ£Ğ¢Ğ Ğ˜ Ñ†Ğ¸ĞºĞ»Ğ°!
        scores = (user_emb[users] * item_emb[items]).sum()
        loss.backward()  # Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ñ‹ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´ÑÑ‚ Ñ‡ĞµÑ€ĞµĞ· forward()
```

### 2. âŒ Negative sampling Ğ¼Ğ¾Ğ³ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ positive item
```python
# Ğ”Ğ (ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):
neg_item = random.randint(0, n_items)  # ĞœĞ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ positive!

# ĞŸĞĞ¡Ğ›Ğ• (ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):
neg_item = random.randint(0, n_items)
while neg_item in user_positive_items:  # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
    neg_item = random.randint(0, n_items)
```

### 3. âŒ Train items Ğ½Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ğ»Ğ¸ÑÑŒ Ğ¿Ñ€Ğ¸ Ğ¾Ñ†ĞµĞ½ĞºĞµ
```python
# Ğ”Ğ (ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):
scores = user_emb @ item_emb.T
top_k = topk(scores, k=10)  # Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ train items!

# ĞŸĞĞ¡Ğ›Ğ• (ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):
scores = user_emb @ item_emb.T
scores[train_mask] = -inf  # ĞœĞ°ÑĞºĞ¸Ñ€ÑƒĞµĞ¼ train items
top_k = topk(scores, k=10)  # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ¾Ğ²Ñ‹Ğµ items
```

---

## ğŸš€ ĞšĞ°Ğº Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ

### 1. ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
```bash
python scripts/prepare_data.py --dataset movie_lens
```

### 2. ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
```bash
python scripts/train_model.py --model lightgcn --dataset movie_lens
```

### 3. Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ²ÑĞµÑ… ÑĞºÑĞ¿ĞµÑ€Ğ¸Ğ¼ĞµĞ½Ñ‚Ğ¾Ğ²
```bash
python scripts/run_all_experiments.py
```

### 4. Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
```
results/experiments/all_experiments_YYYYMMDD_HHMMSS.json
results/experiments/all_experiments_YYYYMMDD_HHMMSS.csv
```

---

## ğŸ“ˆ Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ ÑÑ‚Ğ°Ñ‚ÑƒÑ

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ |
|-----------|--------|----------|
| **Data Pipeline** | âœ… Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ | 100% |
| **ĞœĞ¾Ğ´ĞµĞ»Ğ¸ (7 ÑˆÑ‚)** | âœ… Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ | 100% |
| **ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ** | âœ… Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ | 100% |
| **Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸** | âœ… Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ | 100% |
| **Over-smoothing Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸** | âŒ ĞĞµÑ‚ | 0% |
| **Depth Analysis** | âŒ ĞĞµÑ‚ | 0% |
| **Ablation Studies** | âŒ ĞĞµÑ‚ | 0% |
| **Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ‚ĞµÑÑ‚Ñ‹** | âŒ ĞĞµÑ‚ | 0% |

**ĞĞ±Ñ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ: 60%** âœ…

---

## ğŸ¯ Ğ§Ñ‚Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ

1. **Over-smoothing Analyzer** ğŸ”´
   - Cosine similarity Ğ¿Ğ¾ ÑĞ»Ğ¾ÑĞ¼
   - MAD (Mean Average Distance)
   - Embedding variance

2. **Depth Analysis** ğŸ”´
   - Ğ­ĞºÑĞ¿ĞµÑ€Ğ¸Ğ¼ĞµĞ½Ñ‚Ñ‹ Ñ n_layers = [2, 4, 8, 16]

3. **Ablation Studies** ğŸŸ¡
   - Ğ‘ĞµĞ· residual connections
   - Ğ‘ĞµĞ· shuffle
   - Ğ Ğ°Ğ·Ğ½Ñ‹Ğµ block_size

4. **Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·** ğŸŸ¡
   - 5 Ğ·Ğ°Ğ¿ÑƒÑĞºĞ¾Ğ² Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ seeds
   - mean Â± std
   - t-tests, p-values

5. **Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ** ğŸŸ¢
   - Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ
   - Over-smoothing Ğ¿Ğ¾ ÑĞ»Ğ¾ÑĞ¼
   - Depth analysis plots

