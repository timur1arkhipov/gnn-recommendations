# –°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –æ–±—É—á–µ–Ω–∏—è GNN

## üìä –ü—Ä–æ–±–ª–µ–º–∞

–í—Å–µ GNN –º–æ–¥–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ **–∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ** –∏ **–æ—á–µ–Ω—å –ø–ª–æ—Ö–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- Recall@10 = 0.0059 (–≤—Å–µ –º–æ–¥–µ–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ!)
- –í 4 —Ä–∞–∑–∞ —Ö—É–∂–µ –ø—Ä–æ—Å—Ç–æ–≥–æ BPR-MF (0.0232)
- Coverage = 1.2% (vs 19.3% —É BPR-MF)
- –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ epoch 1

## üîß –†–µ—à–µ–Ω–∏–µ

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è embeddings** ‚≠ê –°–ê–ú–û–ï –í–ê–ñ–ù–û–ï!
   - –ë—ã–ª–æ: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 100 –±–∞—Ç—á–µ–π
   - –°—Ç–∞–ª–æ: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –±–∞—Ç—á–∞
   - –ë–µ–∑ —ç—Ç–æ–≥–æ –º–æ–¥–µ–ª—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –æ–±—É—á–∞–ª–∞—Å—å!

2. **–£–º–µ–Ω—å—à–µ–Ω learning rate**
   - –ë—ã–ª–æ: 0.001
   - –°—Ç–∞–ª–æ: 0.0001 (–≤ 10 —Ä–∞–∑ –º–µ–Ω—å—à–µ)

3. **–£–≤–µ–ª–∏—á–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**
   - –ë—ã–ª–æ: init_scale = 0.01
   - –°—Ç–∞–ª–æ: init_scale = 0.1 (–≤ 10 —Ä–∞–∑ –±–æ–ª—å—à–µ)

4. **–î–æ–±–∞–≤–ª–µ–Ω gradient clipping**
   - max_grad_norm = 1.0
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç exploding gradients

5. **–î–æ–±–∞–≤–ª–µ–Ω learning rate warmup**
   - –ü–µ—Ä–≤—ã–µ 5 —ç–ø–æ—Ö: –ª–∏–Ω–µ–π–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ LR
   - –ó–∞—Ç–µ–º: cosine annealing

6. **–£–≤–µ–ª–∏—á–µ–Ω patience**
   - –ë—ã–ª–æ: 20 —ç–ø–æ—Ö
   - –°—Ç–∞–ª–æ: 50 —ç–ø–æ—Ö

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (6 —Ñ–∞–π–ª–æ–≤):
- `config/models/lightgcn.yaml`
- `config/models/gcnii.yaml`
- `config/models/dgr.yaml`
- `config/models/layergcn.yaml`
- `config/models/svd_gcn.yaml`
- `config/models/groupshuffle_gnn.yaml`

### –ö–æ–¥ (1 —Ñ–∞–π–ª):
- `src/training/trainer.py`
  - –î–æ–±–∞–≤–ª–µ–Ω gradient clipping
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è embeddings
  - –î–æ–±–∞–≤–ª–µ–Ω learning rate warmup
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ LR

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (3 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞):
- `FIXES_APPLIED.md` - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- `QUICK_START_FIXED.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
- `CHANGES_SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
```
LightGCN:  Recall@10 = 0.0059, Coverage = 1.2%, Epoch = 1
GCNII:     Recall@10 = 0.0059, Coverage = 1.2%, Epoch = 1
DGR:       Recall@10 = 0.0059, Coverage = 1.2%, Epoch = 1
...–≤—Å–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ!
```

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (–æ–∂–∏–¥–∞–µ—Ç—Å—è):**
```
LightGCN:  Recall@10 = 0.025-0.035, Coverage = 15-20%, Epoch = 30-80
GCNII:     Recall@10 = 0.020-0.030, Coverage = 15-20%, Epoch = 20-60
DGR:       Recall@10 = 0.022-0.032, Coverage = 15-20%, Epoch = 25-70
...—Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã!
```

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
cd gnn-recommendations
python scripts/run_all_experiments.py
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –î–∞—Ç–∞—Å–µ—Ç Gowalla —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è RTX 4060. –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ —Å–ø–∏—Å–∫–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.

## üìà –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç

### 1. –†–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
–ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏, –Ω–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ!

### 2. GNN —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã —Å BPR-MF
GNN –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ 4 —Ä–∞–∑–∞ —Ö—É–∂–µ. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ (LightGCN, GroupShuffle) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–ª—É—á—à–µ**.

### 3. –ù–æ—Ä–º–∞–ª—å–Ω—ã–π Coverage
–î–æ–ª–∂–µ–Ω –±—ã—Ç—å 15-20%, –Ω–µ 1%.

### 4. –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è
–ú–æ–¥–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –æ–±—É—á–∞—Ç—å—Å—è 20-100 —ç–ø–æ—Ö, –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ 1-–π.

### 5. Learning rate –º–µ–Ω—è–µ—Ç—Å—è
–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ LR:
```
Epoch   1/300 | LR: 0.000020 | ...  (warmup)
Epoch   5/300 | LR: 0.000100 | ...  (–∫–æ–Ω–µ—Ü warmup)
Epoch  50/300 | LR: 0.000085 | ...  (cosine decay)
```

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ—á–µ–º—É embeddings –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–π –±–∞—Ç—á?

–í GNN:
1. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã** (–≤–µ—Å–∞) –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `optimizer.step()`
2. **Embeddings** –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `model(adj_matrix)` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ï—Å–ª–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å embeddings:
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ–Ω—è—é—Ç—Å—è ‚úÖ
- –ù–æ embeddings –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞—Ä—ã–º–∏ ‚ùå
- Loss –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—ã—Ö embeddings ‚ùå
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ ‚ùå
- **–ú–æ–¥–µ–ª—å –Ω–µ –æ–±—É—á–∞–µ—Ç—Å—è!** ‚ùå

–≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –≤—Å–µ –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –ø—Ä–æ–±–ª–µ–º—ã!

### –ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω –º–∞–ª–µ–Ω—å–∫–∏–π learning rate?

GNN —É—Å–∏–ª–∏–≤–∞—é—Ç —Å–∏–≥–Ω–∞–ª —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ–æ–≤—É—é —Å–≤–µ—Ä—Ç–∫—É:
```
x_new = A @ x_old
```

–ö–∞–∂–¥—ã–π —Å–ª–æ–π —É–º–Ω–æ–∂–∞–µ—Ç –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É —Å–º–µ–∂–Ω–æ—Å—Ç–∏. –ó–∞ 3 —Å–ª–æ—è:
```
x_final = A @ A @ A @ x_initial = A¬≥ @ x_initial
```

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–æ–ª—å—à–∏–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º ‚Üí –Ω—É–∂–µ–Ω –º–∞–ª–µ–Ω—å–∫–∏–π LR.

### –ü–æ—á–µ–º—É –Ω—É–∂–Ω–∞ –±–æ–ª—å—à–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è?

–° –º–∞–ª–µ–Ω—å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π (0.01):
- –ù–∞—á–∞–ª—å–Ω—ã–µ embeddings –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–µ
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã —Ç–æ–∂–µ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–µ
- –° –º–∞–ª–µ–Ω—å–∫–∏–º LR –º–æ–¥–µ–ª—å –≤–æ–æ–±—â–µ –Ω–µ –¥–≤–∏–≥–∞–µ—Ç—Å—è
- –ó–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –≤ –Ω–∞—á–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏

–° –±–æ–ª—å—à–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π (0.1):
- –ù–∞—á–∞–ª—å–Ω—ã–µ embeddings –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏–µ
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ
- –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –æ–±—É—á–∞—Ç—å—Å—è

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- `FIXES_APPLIED.md` - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `QUICK_START_FIXED.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
- `SYSTEM_OVERVIEW.md` - –æ–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- `src/models/MODELS_GUIDE.md` - –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å Gowalla (–µ—Å–ª–∏ RTX 4060)
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ GPU –¥–æ—Å—Ç—É–ø–µ–Ω: `python scripts/check_gpu.py`
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è LR
- [ ] –°—Ä–∞–≤–Ω–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ —Å—Ç–∞—Ä—ã–º–∏
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–æ–¥–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å—ë –µ—â—ë –ø–ª–æ—Ö–∏–µ** ‚Üí —É–º–µ–Ω—å—à–∏—Ç–µ LR –¥–æ 0.00005
2. **Loss –Ω–µ –ø–∞–¥–∞–µ—Ç** ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã (–¥–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
3. **OOM error** ‚Üí —É–º–µ–Ω—å—à–∏—Ç–µ batch_size –¥–æ 1024
4. **–°–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ** ‚Üí —É–≤–µ–ª–∏—á—å—Ç–µ eval_every –¥–æ 20

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**: 09.01.2026  
**–ê–≤—Ç–æ—Ä**: AI Assistant  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

